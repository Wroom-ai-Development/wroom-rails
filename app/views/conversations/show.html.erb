
<div id='view-header'>
  <h1><%= @conversation.title %></h1>
  <%= link_to "edit", edit_conversation_path %>
</div>
<div id='conversation'>
  <div id='conversation-documents'>
    <div id='conversation-documents-header'>
      Reference material:
    </div>
    <% @conversation.documents.each do |document| %>
      <div class='conversation-document'>
        <span class='bullet'>•</span> <%= link_to document.title, document %>
      </div>
    <% end %>
  </div>
  <div id='messages'>
    <% @conversation.messages.each do |message| %>
      <div class='message <%= message.role %>'>
        <div class='content'>
          <%= message.content %>
          <% if message.partial_answers.present? %>
            <details>
              <summary>Partial answers:</summary>
              <% message.partial_answers.each do |answer| %>
                <p><%= answer %></p>
              <% end %>
            </details>
          <% end %>
        </div>
      </div>
    <% end %>
    </div>
    <%= form_with url: new_user_message_conversation_path, id: 'new-message-form'  do |f| %>
      <%= f.text_field (:content) %>
      <%= f.submit '➥', id: 'submit' %>
    <% end %>
</div>

<script>
  function animateBorder() {
    console.log('hello');
    const messages = document.getElementById('messages');
    messages.classList.add('messages-animated') 
  }

  const newMessageForm = document.getElementById('new-message-form')

  newMessageForm.addEventListener('turbo:submit-start', function() {
    console.log('hello1');  
    animateBorder();
    // const submit = document.getElementById('submit');
    // submit.addEventListener('click', function(e) {
    //   // e.preventDefault();
    // })
  })
</script>